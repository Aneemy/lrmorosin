{"ast":null,"code":"import React,{useEffect,useState}from'react';import Input from\"./ui/Input\";import{login,registration}from\"./http/auth\";import{jwtDecode}from\"jwt-decode\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Auth=_ref=>{let{changeUser}=_ref;const[username,setUsername]=useState('');const[password,setPassword]=useState('');const[message,setMessage]=useState(null);const[isLogin,setIsLogin]=useState(true);const refreshPage=user=>setTimeout(()=>changeUser(user),1500);const AuthForm=()=>{return/*#__PURE__*/_jsxs(\"div\",{className:\"auth__content\",children:[/*#__PURE__*/_jsx(Input,{value:username,setValue:setUsername}),/*#__PURE__*/_jsx(Input,{value:password,setValue:setPassword})]});};const sendRegReq=async()=>{if(isLogin){setIsLogin(false);}else{const response=await registration({username,password});setMessage(response.message);}};const sendLogReg=async()=>{if(!isLogin){setIsLogin(true);}else{const response=await login({username,password});setMessage(response);}};const Message=()=>{if(message!==null){const tempMsg=message;setMessage('');if(tempMsg.message!==null&&!tempMsg.token){return/*#__PURE__*/_jsx(\"div\",{children:\"\\u0412\\u044B \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u0437\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u043B\\u0438\\u0441\\u044C\"});}else if(typeof tempMsg.token==='string'){const data=jwtDecode(tempMsg.token);const user=data;localStorage.setItem('token',tempMsg.token);refreshPage(user);return/*#__PURE__*/_jsx(\"div\",{children:\"\\u0412\\u044B \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u0430\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u043E\\u0432\\u0430\\u043B\\u0438\\u0441\\u044C, \".concat(user)});}return null;}};return/*#__PURE__*/_jsx(\"div\",{className:\"auth__bg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"auth__content\",children:[/*#__PURE__*/_jsx(Input,{value:username,setValue:setUsername,placeholder:\"\\u0418\\u043C\\u044F \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\"}),/*#__PURE__*/_jsx(Input,{value:password,setValue:setPassword,placeholder:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"auth__buttons\",children:[/*#__PURE__*/_jsx(\"div\",{className:!isLogin&&'active',onClick:()=>sendRegReq(),children:\"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F\"}),/*#__PURE__*/_jsx(\"div\",{className:isLogin&&'active',onClick:()=>sendLogReg(),children:\"\\u041B\\u043E\\u0433\\u0438\\u043D\"})]}),/*#__PURE__*/_jsx(Message,{})]})});};export default Auth;","map":{"version":3,"names":["React","useEffect","useState","Input","login","registration","jwtDecode","jsx","_jsx","jsxs","_jsxs","Auth","_ref","changeUser","username","setUsername","password","setPassword","message","setMessage","isLogin","setIsLogin","refreshPage","user","setTimeout","AuthForm","className","children","value","setValue","sendRegReq","response","sendLogReg","Message","tempMsg","token","data","localStorage","setItem","concat","placeholder","onClick"],"sources":["E:/code/lrmorosin/src/Auth.jsx"],"sourcesContent":["import React, {useEffect, useState} from 'react';\r\nimport Input from \"./ui/Input\";\r\nimport {login, registration} from \"./http/auth\";\r\nimport {jwtDecode} from \"jwt-decode\";\r\n\r\nconst Auth = ({changeUser}) => {\r\n    const [username,setUsername] = useState('')\r\n    const [password,setPassword] = useState('')\r\n    const [message,setMessage] = useState(null)\r\n    const [isLogin,setIsLogin] = useState(true)\r\n\r\n    const refreshPage = (user)=> setTimeout(()=>changeUser(user),1500)\r\n    const AuthForm = () =>{\r\n        return(\r\n            <div className=\"auth__content\">\r\n                <Input value={username} setValue={setUsername}/>\r\n                <Input value={password} setValue={setPassword}/>\r\n            </div>\r\n        )\r\n    }\r\n    const sendRegReq =  async () =>{\r\n        if (isLogin){\r\n            setIsLogin(false)\r\n        }\r\n        else{\r\n            const response = await registration({username,password})\r\n            setMessage(response.message)\r\n        }\r\n    }\r\n    const sendLogReg = async () =>{\r\n        if (!isLogin){\r\n            setIsLogin(true)\r\n        }\r\n        else{\r\n            const response = await login({username,password})\r\n            setMessage(response)\r\n        }\r\n    }\r\n    const Message = () =>{\r\n        if (message!==null){\r\n        const tempMsg = message\r\n        setMessage('')\r\n        if (tempMsg.message!==null&& !tempMsg.token){\r\n            return <div>\r\n                Вы успешно зарегистрировались\r\n            </div>\r\n        }\r\n        else if (typeof(tempMsg.token) === 'string' ){\r\n            const data = jwtDecode(tempMsg.token)\r\n            const user = data\r\n            localStorage.setItem('token',tempMsg.token)\r\n            refreshPage(user)\r\n            return <div>\r\n                {`Вы успешно авторизовались, ${user}`}\r\n            </div>\r\n        }\r\n        return null\r\n    }\r\n        }\r\n\r\n    return (\r\n        <div className=\"auth__bg\">\r\n            <div className=\"auth__content\">\r\n                <Input value={username} setValue={setUsername} placeholder='Имя пользователя'/>\r\n                <Input value={password} setValue={setPassword} placeholder='Пароль'/>\r\n                <div className=\"auth__buttons\">\r\n                    <div className={!isLogin&&'active'} onClick={()=>sendRegReq()}>\r\n                        Регистрация\r\n                    </div>\r\n                    <div className={isLogin&&'active'} onClick={()=>sendLogReg()}>\r\n                        Логин\r\n                    </div>\r\n                </div>\r\n                <Message/>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Auth;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}